<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="./assets/SecretPyramid.png" type="image/x-icon">
  <title>Decent NDA</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/right-panel.css">
</head>
<body>
  <!-- Background Video -->
  <video autoplay muted loop id="background-video">
    <source src="./assets/SecretPyramid.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>

  <!-- Header -->
<!-- Header -->
<header class="header">
    <!-- Contract Address (Upper Left Corner) -->
    <div id="contract-address" class="contract-info upper-left" style="display: none;">
        <a id="contract-address-text" href="#" target="_blank"></a>
    </div>

    <div class="centered-title">
        <div class="title">
            <img src="./assets/SecretPyramid.png" alt="Secret Pyramid" class="header-icon">
            <img src="./assets/Eth.gif" alt="Ethereum Icon" class="header-icon">
            <h1> - ‚∏¨ - Decent ‚ö∏<div class="holy-cross"> ‚ò• </div>üßû‚Äç‚ôÇÔ∏è NDA - ‚∏¨ -</h1>
            <img src="./assets/Eth.gif" alt="Ethereum Icon" class="header-icon">
            <img src="./assets/SecretPyramid.png" alt="Secret Pyramid" class="header-icon">
        </div>

        <div class="wallet-display" id="wallet-display">Not Connected</div>
        
        <!-- NDA Hash (Pinned to Bottom) -->
        <div id="hash-info" class="hash-info hidden">
            <span id="get-nda-hash-response">Loading NDA Hash ...</span>
        </div>
    </div>

    <button id="connect-wallet" class="wallet-button wallet-disconnected">
        <img src="./assets/metamask.png" alt="MetaMask" />
    </button>
</header>

  <!-- Page Container: Left = Form | Right = NDA Display -->
  <div class="page-container">
    <!-- Left: NDA Form -->
    <div class="left-panel">
      <form id="nda-form">
        <h1>Decent NDA</h1>

        <!-- Sign NDA -->
        <div class="form-section">
          <h2>Sign Agreement</h2>
          <input type="text" id="hashed-message" class="input-field" placeholder="Hashed Message">
          <button type="button" class="action-button" id="sign-nda">Sign NDA</button>
          <p class="response-message" id="sign-nda-response"></p>
        </div>

        <br><hr><br>

        <!-- Verify Signature -->
        <div class="form-section">
          <h2>Verify Signature</h2>
          <input type="text" id="verify-hashed-message" class="input-field" placeholder="Hashed Message">
          <button type="button" class="action-button" id="verify-signature">Verify</button>
          <p class="response-message" id="verify-signature-response"></p>
        </div>

        <br><hr><br>

        <!-- Update NDA Hash (Owner Only) -->
        <div class="form-section">
            <h2>Update NDA Hash</h2>
            <input type="text" id="new-nda-hash" class="input-field" placeholder="Enter New NDA Hash">
            <button type="button" class="action-button" id="update-nda">Update NDA</button>
            <p class="response-message" id="update-nda-hash-response"></p>
        </div>
      </form>
    </div>

    <!-- Right: NDA Display (Only for Authorized Users) -->
    <div class="right-panel hidden" id="nda-panel">

    <!-- Input fields for IV & Key -->
    <input type="text" id="decrypt-iv" class="input-field" placeholder="Enter IV">
    <input type="text" id="decrypt-key" class="input-field" placeholder="Enter Key">
    <input type="text" id="decrypt-hash" class="input-field" placeholder="Enter Hash">
    <!-- Decrypt NDA Button -->
    <button type="button" class="action-button" id="decrypt-nda">Decrypt NDA</button>

    <!-- NDA Modal -->
    <div id="nda-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Decrypted NDA</h2>
            <pre id="nda-modal-content">No NDA Loaded</pre>
        </div>
    </div>

        <!-- Upload NDA Section -->
        <div class="upload-nda-section">
            <h2>Upload NDA</h2>
            <input type="file" id="file-input" />
            <button type="button" id="convert-to-json">Convert to JSON</button>
            
            <!-- JSON Display Area -->
            <textarea id="nda-json" class="input-field" placeholder="Converted JSON will appear here"></textarea>

            <!-- Encrypt JSON Button -->
            <button type="button" id="encrypt-nda">Encrypt NDA</button>

            <!-- Encrypted JSON Display Area -->
            <textarea id="encrypted-nda" class="input-field" placeholder="Encrypted JSON will appear here" readonly></textarea>

            <!-- Manual Upload Instructions -->
            <p>Copy the encrypted NDA and upload to IPFS manually.</p>
        </div>
    </div>

  </div>

  <!-- JS Libraries -->
    <!-- Web3 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.0/web3.min.js"></script>
    <!-- W3UP Client (No Import Needed) -->
    <script src="https://cdn.jsdelivr.net/npm/@web3-storage/w3up-client@17.1.2/browser.min.js"></script>
    <!-- Custom Scripts -->
    <script src="js/encryption.js"></script>
    <script src="js/w3up.js"></script>
    <script src="js/app.js"></script>

</body>
</html>